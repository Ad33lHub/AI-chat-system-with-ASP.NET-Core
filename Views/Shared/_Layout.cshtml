<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - VerixSoft</title>
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Google Fonts - Inter & Poppins for modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Site CSS -->
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <!-- Navigation Header -->
    <header class="navbar">
        <div class="container nav-content">
            <!-- Logo -->
            <a class="nav-logo" asp-area="" asp-controller="Home" asp-action="Index" title="VerixSoft Home">
                <i data-lucide="zap" class="w-6 h-6"></i>
                <span>VerixSoft</span>
            </a>

            <!-- Navigation Links -->
            <nav class="nav-links" role="navigation">
                <a class="nav-link" asp-controller="Home" asp-action="Index">Home</a>
                <a class="nav-link" href="#services">Services</a>
                <a class="nav-link" href="#contact">Contact</a>
            </nav>

            <!-- CTA Button -->
            <div class="flex items-center gap-4">
                <a href="#contact" class="btn btn-primary btn-sm" title="Get started with VerixSoft">
                    Get Started
                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main role="main" class="main-content">
        @RenderBody()
    </main>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <!-- Footer Content Grid -->
            <div class="footer-grid">
                <!-- Brand Section -->
                <div class="footer-section">
                    <h3 class="flex items-center gap-2 mb-4">
                        <i data-lucide="zap" class="w-5 h-5 text-primary"></i>
                        VerixSoft
                    </h3>
                    <p class="text-sm text-muted-foreground leading-relaxed">
                        Building exceptional software solutions that drive business growth and innovation. 
                        Specialized in web, mobile, and AI technologies.
                    </p>
                </div>

                <!-- Products -->
                <div class="footer-section">
                    <h3>Services</h3>
                    <ul class="footer-links">
                        <li><a href="#services">Web Development</a></li>
                        <li><a href="#services">Mobile Apps</a></li>
                        <li><a href="#services">Cloud Solutions</a></li>
                        <li><a href="#services">AI Integration</a></li>
                    </ul>
                </div>

                <!-- Company -->
                <div class="footer-section">
                    <h3>Company</h3>
                    <ul class="footer-links">
                        <li><a href="#portfolio">Portfolio</a></li>
                        <li><a href="#blog">Blog</a></li>
                        <li><a href="#careers">Careers</a></li>
                    </ul>
                </div>

                <!-- Legal & Social -->
                <div class="footer-section">
                    <h3>Legal</h3>
                    <ul class="footer-links">
                        <li><a asp-controller="Home" asp-action="Privacy">Privacy Policy</a></li>
                        <li><a href="#terms">Terms of Service</a></li>
                        <li><a href="#contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <p>&copy; 2025 VerixSoft. All rights reserved. | Crafted with <i data-lucide="heart" style="display: inline; width: 16px; height: 16px; color: #ef4444; stroke-width: 3;"></i> by our team</p>
            </div>
        </div>
    </footer>

    <!-- Chat Widget -->
    <div id="chat-widget" class="chat-widget">
        <!-- Floating Action Button -->
        <button id="chat-fab" class="chat-fab" title="Chat with AI" aria-label="Open Chat">
            <i data-lucide="message-circle" class="w-8 h-8"></i>
        </button>

        <!-- Chat Window -->
        <div id="chat-window" class="chat-window hidden">
            <div class="chat-header">
                <div class="chat-title">
                    <i data-lucide="bot" class="w-5 h-5 text-primary"></i>
                    <span>Verix AI</span>
                </div>
                <button id="chat-close" class="chat-close" aria-label="Close Chat">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div id="chat-messages" class="chat-messages">
                <div class="chat-message bot">
                    <div class="message-content">
                        Hi! I'm Verix AI. How can I help you today?
                    </div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Type your message..." autocomplete="off">
                <button id="chat-send" aria-label="Send Message">
                    <i data-lucide="send" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Initialize Lucide Icons
        document.addEventListener('DOMContentLoaded', function () {
            lucide.createIcons();
            initChatWidget();
        });

        function initChatWidget() {
            const fab = document.getElementById('chat-fab');
            const window = document.getElementById('chat-window');
            const closeBtn = document.getElementById('chat-close');
            const input = document.getElementById('chat-input');
            const sendBtn = document.getElementById('chat-send');
            const messages = document.getElementById('chat-messages');

            // Toggle Chat
            function toggleChat() {
                window.classList.toggle('hidden');
                if (!window.classList.contains('hidden')) {
                    input.focus();
                }
            }

            fab.addEventListener('click', toggleChat);
            closeBtn.addEventListener('click', toggleChat);

            // Send Message
            async function sendMessage() {
                const text = input.value.trim();
                if (!text) return;

                // Add User Message
                appendMessage(text, 'user');
                input.value = '';

                // Show Typing Indicator
                const typingId = showTyping();

                try {
                    const response = await fetch('/api/chat/send', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ message: text })
                    });
                    
                    removeTyping(typingId);

                    if (response.ok) {
                        const data = await response.json();
                        appendMessage(data.response, 'bot');
                    } else {
                        appendMessage("Sorry, I'm having trouble connecting right now.", 'bot');
                    }
                } catch (err) {
                    removeTyping(typingId);
                    appendMessage("Network error. Please try again.", 'bot');
                }
            }

            sendBtn.addEventListener('click', sendMessage);
            input.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') sendMessage();
            });

            function appendMessage(text, sender) {
                const div = document.createElement('div');
                div.classList.add('chat-message', sender);
                div.innerHTML = `<div class="message-content">${text}</div>`;
                messages.appendChild(div);
                messages.scrollTop = messages.scrollHeight;
            }

            function showTyping() {
                const id = 'typing-' + Date.now();
                const div = document.createElement('div');
                div.id = id;
                div.classList.add('chat-message', 'bot', 'typing');
                div.innerHTML = `<div class="message-content">...</div>`;
                messages.appendChild(div);
                messages.scrollTop = messages.scrollHeight;
                return id;
            }

            function removeTyping(id) {
                const el = document.getElementById(id);
                if (el) el.remove();
            }
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href !== '#' && document.querySelector(href)) {
                    e.preventDefault();
                    const element = document.querySelector(href);
                    element?.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add scroll effect to navbar
        window.addEventListener('scroll', function () {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.boxShadow = '0 4px 12px rgba(13, 17, 23, 0.1)';
            } else {
                navbar.style.boxShadow = '0 1px 3px rgba(13, 17, 23, 0.05)';
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
